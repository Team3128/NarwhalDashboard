<html>
	<head>
		<meta charset="UTF-8">
        <title>NarwhalDashboard</title>
        
        <link rel="stylesheet" type="text/css" href="base/dash.css" />
        
        <script type="text/javascript" src="base/dash.js"></script>
        <script src="ext-js/canvas-gauges/gauge.min.js"></script>

        <script>
            var battGauge, speedGauge;
            var clear = "rgba(0,0,0,0)";

            function makeGauge(id, size, min, max, major_ticks, minor_ticks, highlights, needle_color, text_color, prog_color, dec, number_size) {
                var gauge = new RadialGauge({ 
                    renderTo: id,
                    width: size,
                    height: size,
                    minValue: min,
                    maxValue: max,
                    majorTicks: major_ticks,
                    minorTicks: minor_ticks,
                    barProgress: true,

                    barWidth: "20%",

                    colorPlate: clear,
                    colorBorderOuter: clear,
                    colorBorderOuterEnd: clear,
                    colorBorderMiddle: clear,
                    colorBorderMiddleEnd: clear,
                    colorBorderInner: clear,
                    colorBorderInnerEnd: clear,

                    colorBorderShadow: "false",
                    colorMajorTicks: text_color,
                    colorNumbers: text_color,
                    fontNumbersWeight: "700",
                    fontNumbersSize: number_size,
                    numbersMargin: 0,

                    colorValueBoxRect: clear,
                    colorValueBoxRectEnd: clear,
                    colorValueBoxShadow: clear,
                    colorValueTextShadow: clear,
                    colorValueBoxBackground: clear,

                    fontNumbers: "Lato",
                    fontValue: "Lato",
                    fontValueSize: "64",
                    valueInt: 1,
                    valueDec: dec,
                    colorValueText: text_color,
                    fontValueWeight: "700",

                    colorNeedleShadowDown: clear,
                    colorNeedleShadowUp: clear,
                    colorNeedle: needle_color,
                    colorNeedleEnd: needle_color,
                    needleStart: 0,
                    needleWidth: 8,
                    colorNeedleCircleOuter: needle_color,
                    colorNeedleCircleOuterEnd: needle_color,
                    colorNeedleCircleInner: needle_color,
                    colorNeedleCircleInnerEnd: needle_color,

                    colorBarProgress: prog_color,

                    highlights: highlights,
                    highlightsWidth: 10,

                    animation: false
                });

                return gauge;
            }

            function makeBar(id, width, height, min, max, major_ticks, minor_ticks, tick_side, highlights, tick_color, text_color, prog_color, dec, number_size) {
                var bar = new LinearGauge({ 
                    renderTo: id,
                    width: width,
                    height: height,
                    minValue: min,
                    maxValue: max,
                    majorTicks: major_ticks,
                    minorTicks: minor_ticks,
                    barProgress: true,
                    
                    tickSide: tick_side,
                    numberSide: tick_side,

                    barProgress: true,
                    barWidth: "30",

                    colorPlate: clear,
                    colorBorderOuter: clear,
                    colorBorderOuterEnd: clear,
                    colorBorderMiddle: clear,
                    colorBorderMiddleEnd: clear,
                    colorBorderInner: clear,
                    colorBorderInnerEnd: clear,

                    colorValueBoxRect: clear,
                    colorValueBoxRectEnd: clear,
                    colorValueBoxShadow: clear,
                    colorValueTextShadow: clear,
                    colorValueBoxBackground: clear,

                    colorMajorTicks: tick_color,
                    colorMinorTicks: tick_color,

                    colorNeedle: clear,
                    colorNeedleEnd: clear,

                    fontNumbers: "Lato",
                    fontValue: "Lato",
                    fontValueSize: "48",
                    valueInt: 1,
                    valueDec: dec,
                    colorValueText: text_color,
                    fontValueWeight: "700",

                    barBeginCircle: false,

                    colorBorderShadow: "false",
                    colorNumbers: text_color,
                    fontNumbersWeight: "700",
                    fontNumbersSize: number_size,
                    numbersMargin: 0,

                    colorBarProgress: prog_color,

                    highlights: highlights,
                    highlightsWidth: 10,

                    animation: false
                });

                return bar;
            }

            function updateData(json) {
                battGauge.value = json['voltage'];
                battGauge.draw();

                sel_auto = json['selected_auto']
                if (sel_auto == "null") {
                    sel_auto = "None";
                }
                
                setInner('selected_auto', sel_auto);
                setInner('match_time', Number(json['time']).toFixed(0));
            }

            function bodyLoad() {
                battGauge = makeGauge('batt_gauge', 160, 0, 15, [0,3,6,9,12,15], 3, [
                        {from:  0, to:  8, color: "#d60000"},
                        {from:  8, to: 12, color: "#efdb00"},
                        {from: 12, to: 15, color: "#41c603"}
                    ], "white", "white", "#0085b2", 2, 32);
                battGauge.value = 12.73;
                battGauge.draw();

                speedGauge = makeGauge('speed_gauge', 200, 0, 20, [0,4,8,12,16,20], 4, [
                        {from:  0, to:  8, color: "#d60000"},
                        {from:  8, to: 15, color: "#efdb00"},
                        {from: 15, to: 20, color: "#41c603"}
                    ], "black", "black", "#072682", 2, 32);
                speedGauge.value = 10.8;
                speedGauge.draw();

                shooterGauge = makeGauge('shooter_gauge', 200, 0, 4000, [0,1000,2000,3000,4000], 4, [
                        {from:    0, to: 3000, color: "#d60000"},
                        {from: 3000, to: 3250, color: "#efdb00"},
                        {from: 3250, to: 3750, color: "#41c603"},
                        {from: 3750, to: 4000, color: "#efdb00"}
                    ], "black", "black", "#0068a5", 0, 24);
                shooterGauge.value = 3500;
                shooterGauge.draw();

                forkBar = makeBar('fork_bar', 200, 500, 0, 8, [0,1,2,3,4,5,6,7,8], 4, "both", [
                        {from: 0, to: 2, color: "#d60000"},
                        {from: 2, to: 4, color: "#efdb00"},
                        {from: 4, to: 5, color: "#41c603"},
                        {from: 5, to: 8, color: "#0085b2"}
                    ], "white", "black", "#0068a5", 2, 36);
                forkBar.value = 2.38;
                forkBar.draw();

                addUpdater(updateData);
            }
        </script>
    </head>
    <button id="rotate" type="button" onclick="rotateCamera()">rotate</button>
	<body onload="bodyLoad()" style="padding: 0px; margin: 0px; background: #efefef;">
        <div class="flexbox column squash" style="width: 100%;">
			<div class="flexbox row navy" style="align-items: center;flex-grow: 0; padding: 10px; margin: 0px">
                <div style="flex: 1 0 auto">
                    <img style="height: 60px" src="assets/logo.png"/>
                </div>
                
                <div id="conn_button" onclick='toggleConnection()' class="button red" style="flex: 0 0 auto; border-radius: 6px; padding: 10px; padding-left: 14px; padding-right: 14px;">
                    <font id="conn_button_text" style="font-size: 20; font-weight: 700">Disconnected</font>
                </div>  
			</div>
            
            <div class="flexbox row squash" style="align-items: stretch;">
                <div class="flexbox column squash" style="flex: 0 0 50%;">
                    <div style="display: flex; align-items: center; flex-direction: row; flex-grow: 0; margin: 25px; margin-bottom: 0px; padding: 16px; background: white; border-radius: 30px;">
                        <div id="battery" style="flex: 0 0 160px; height: 160px; background: #b0b0b0; border-radius: 14px; padding: 10px; color: white; text-align: center; vertical-align: middle;">
                            <font style="font-size: 18pt; line-height: 12pt">Battery</font>
                            <canvas id="batt_gauge"></canvas>  
                        </div>
                            
                        <div style="flex: 1 0 auto; text-align: center; vertical-align: middle;">
                            <font id="match_time" style="font-size: 60pt; line-height: 64pt">118s</font>
                            <br>
                            <font style="font-size: 18pt; line-height: 20pt">Match Time Remaining</font>
                        </div>
                    </div>
                        
                    <div style="display: flex; align-items: strech; flex-direction: column; flex-grow: 0; margin: 25px; margin-bottom: 0px; padding: 12px; background: #072682; border-radius: 16px;">
                        <div style="display: flex; align-items: center; flex-direction: row; color: white; font-size: 14pt;">
                            <font style="font-weight: 300; margin-right: 8px;">Selected Auto:</font>
                            <font id="selected_auto" style="font-weight: 600; flex: 1 0 auto">No autonomous selected</font>  
                            <div onclick='toggleAutoMenu()' class="button sapphire" style="border-radius: 6px; padding: 4px; padding-left: 14px; padding-right: 14px;">Choose</div>      
                        </div>
                        <div id="auto_list" style='display: none; margin-top: 10px;'>
                            <div id="auto_choice_none" onclick="select_auto(-1)" class="button sapphire" style="margin: 0px; margin-bottom: 4px; padding: 8px; border-radius: 6px;">
                                None
                            </div>
            
                                <!-- <div id="auto_choice" class="button sapphire" class="button" style="margin: 0px; margin-bottom: 4px; padding: 8px; border-radius: 6px;">
                                    Cross Baseline
                                </div>
                                <div id="auto_choice" class="button sapphire" class="button" style="margin: 0px; margin-bottom: 4px; padding: 8px; border-radius: 6px;">
                                    Center Switch
                                </div> -->
                        </div>
                    </div>

                    <div class="flexbox row" style="align-items: center; justify-content: center; margin: 25px; margin-bottom: 0px;">
                        <div style="text-align: center; flex: 0 0 auto">
                            <font style="font-size: 14pt">Robot Speed (ft/s)</font>
                            <br>
                            <canvas id="speed_gauge"></canvas>
                        </div>
                        
                        <div style="text-align: center; flex: 0 0 auto">
                            <font style="font-size: 14pt">Shooter Speed (RPM)</font>
                            <br>
                            <canvas id="shooter_gauge"></canvas>
                        </div>
                    </div>
                </div>

                <div style="flex: 0 0 160px; text-align: center; padding: 20px; padding-right: 4px; padding-left: 4px;">
                    <br>
                    <font style="font-size: 14pt">Forklift Height (ft)</font>
                    <br>
                    <canvas id="fork_bar"></canvas>
                </div>

                <div class="flexbox column squash" style="flex: 1 0 auto; align-items: stretch; padding: 0px; padding: 16px">
                    <div onmousedown='buttonDown("rezero")' onmouseup='buttonUp("rezero")' class="button dark_blue" style="flex: 0 0 auto; border-radius: 12px; padding: 20px; margin-bottom: 10px;">
                        <font id="conn_button_text" style="font-size: 20">Rezero Forklift</font>
                    </div> 
                    <div onmousedown='buttonDown("say_hi")' onmouseup='buttonUp("say_hi")' class="button medium_blue" style="flex: 0 0 auto; border-radius: 12px; padding: 20px; margin-bottom: 10px;">
                        <font id="conn_button_text" style="font-size: 20">Stop Compressor</font>
                    </div> 
                    <div onmousedown='buttonDown("say_hi")' onmouseup='buttonUp("say_hi")' class="button light_blue" style="flex: 0 0 auto; border-radius: 12px; padding: 20px; margin-bottom: 10px;">
                        <font id="conn_button_text" style="font-size: 20">Forklift Manual Override</font>
                    </div> 
                    <div onmousedown='buttonDown("say_hi")' onmouseup='buttonUp("say_hi")' class="button lightest_blue" style="flex: 0 0 auto; border-radius: 12px; padding: 20px; margin-bottom: 10px;">
                        <font id="conn_button_text" style="font-size: 20">Engage Climber Lock Pistons</font>
                    </div> 
                    <div id="camera" style="flex: 0 0 auto; border-radius: 12px; padding: 20px; margin-bottom: 10px;"></div>
                </div>
            </div>
        </div>
	</body>
</html>